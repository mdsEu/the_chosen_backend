(()=>{var t={991:t=>{t.exports=function(){return this.lodash}()},514:t=>{t.exports=function(){return this.wp.apiFetch}()},15:t=>{t.exports=function(){return this.wp.data}()},470:t=>{t.exports=function(){return this.wp.url}()}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,r),s.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n);var t=r(514),e=r.n(t),a=r(15),s=r(991),o=r(470);const i="pll/metabox",u="core/editor",l="core/edit-site",c="core",p={languages:[],selectedLanguage:{},translatedPosts:{},fromPost:null,currentTemplatePart:{}};function d(){const t=(0,a.select)(i).getLanguages();return Array.from(t.values()).find((t=>t.is_default_lang))}function g(t){t.path=(0,o.addQueryArgs)(t.path,{is_block_editor:!0})}function f(t,e){const r=(0,o.hasQueryArg)(t.path,"lang");((0,s.isUndefined)(t.filterLang)||t.filterLang)&&!r&&(t.path=(0,o.addQueryArgs)(t.path,{lang:e}))}function m(t){const e=new URL(document.location).searchParams,r=e.get("postType"),n=e.get("postId"),i=(0,a.select)("core/edit-post")?.isEditingTemplate();("wp_template_part"===r&&!(0,s.isNil)(n)||i)&&function(t){t.path=(0,o.addQueryArgs)(t.path,{include_untranslated:!0})}(t)}function _(){return document.getElementById("site-editor")||document.getElementById("edit-site-editor")?(0,a.select)(l).getEditedPostType():(0,a.select)(u).getCurrentPostType()}const P={setLanguages:t=>({type:"SET_LANGUAGES",languages:t}),setCurrentUser:(t,e=!1)=>({type:"SET_CURRENT_USER",currentUser:t,save:e}),setFromPost:t=>({type:"SET_FROM_POST",fromPost:t}),fetchFromAPI:t=>({type:"FETCH_FROM_API",options:t}),setCurrentTemplatePart:t=>({type:"SET_CURRENT_TEMPLATE_PART",currentTemplatePart:t})},T=(0,a.createReduxStore)(i,{reducer(t=p,r){switch(r.type){case"SET_LANGUAGES":return{...t,languages:r.languages};case"SET_CURRENT_USER":return r.save&&(n=r.currentUser,e()({path:"/wp/v2/users/me",data:n,method:"POST"})),{...t,currentUser:r.currentUser};case"SET_FROM_POST":return{...t,fromPost:r.fromPost};case"SET_CURRENT_TEMPLATE_PART":return{...t,currentTemplatePart:r.currentTemplatePart};default:return t}var n},selectors:{getLanguages:t=>t.languages,getCurrentUser:t=>t.currentUser,getFromPost:t=>t.fromPost,getCurrentTemplatePart:t=>t.currentTemplatePart},actions:P,controls:{FETCH_FROM_API:t=>e()({...t.options})},resolvers:{*getLanguages(){const t=yield P.fetchFromAPI({path:"/pll/v1/languages",filterLang:!1});return P.setLanguages(function(t,e){const r=new Map;return t.reduce((function(t,r){return t.set(r[e],r),t}),r),r}(t,"slug"))},*getCurrentUser(){const t=yield P.fetchFromAPI({path:"/wp/v2/users/me",filterLang:!0});return P.setCurrentUser(t)},*getCurrentTemplatePart(){const t=y();return P.setCurrentTemplatePart(t)}}});(0,a.register)(T);new Promise((function(t){let e=(0,a.subscribe)((function(){(0,a.select)(i).getLanguages().size>0&&(e(),t())}))}));function y(){const t=(0,a.select)(l)?.getEditedPostId(),e=(0,a.select)(l)?.getEditedPostType();return(0,a.select)(c).getEntityRecord("postType",e,t)}function h(){const t=(0,a.select)(u).getEditedPostAttribute("lang");if(!(0,s.isUndefined)(t)&&t)return t;const e=new URL(document.location).searchParams,r=e.get("postType"),n=e.get("postId");if("wp_template_part"===r&&(0,s.isNil)(n))return pll_block_editor_plugin_settings.lang=d(),pll_block_editor_plugin_settings.lang.slug;const o=y(),i=o?.lang;return!(0,s.isUndefined)(i)&&i?i:pll_block_editor_plugin_settings.lang.slug}e().use(((t,e)=>{if(!(0,s.isUndefined)(t.url))return e(t);const r=h();if(function(t){return!(0,s.isNil)(t.data)}(t))return g(t),function(t){return"POST"===t.method&&t.path.match(/^\/wp\/v2\/template-parts(?:\/|\?|$)/)&&(0,s.isNil)(t.data.from_post)&&(0,s.isNil)(t.data.lang)}(t)&&f(t,d()?.slug),function(t){const e=(0,s.map)((0,a.select)("core").getEntitiesByKind("postType"),(0,s.property)("baseURL")),r=(0,a.select)("core/editor").getCurrentPostId(),n=t.data.id;return-1!==e.findIndex((function(e){return new RegExp(`${(0,s.escapeRegExp)(e)}`).test(t.path)}))&&r===n}(t)||function(t){return"POST"===t.method&&t.path.match(/^\/wp\/v2\/template-parts(?:\/|\?|$)/)&&!(0,s.isNil)(t.data.from_post)&&!(0,s.isNil)(t.data.lang)}(t)||f(t,r),function(t,e){const r=function(t){const e=(0,a.select)("core").getEntitiesByKind("postType"),r=(0,s.find)(e,{name:t});return r?.baseURL}("wp_template_part");if((0,s.isUndefined)(r))return;const n=new RegExp((0,s.escapeRegExp)(r));if("POST"==t.method&&n.test(t.path)){if(!(0,a.select)(i).getLanguages().get(e).is_default_lang){const r="___"+e;t.data.slug+=r}}}(t,r),e(t);"wp_template"===_()&&f(t,d()?.slug);return new RegExp(/^\/wp\/v2\/template-parts\/?(?:\?.*)?$/).test(t.path)&&m(t),f(t,r),g(t),e(t)})),"undefined"!=typeof jQuery&&jQuery((function(t){t.ajaxPrefilter((function(t,e,r){if(-1!=t.url.indexOf(ajaxurl)||-1!=ajaxurl.indexOf(t.url)){const n=h(),a={lang:n};function s(){const e="lang="+n;if(void 0===t.data||""===t.data.trim())t.data=e;else try{t.data=JSON.stringify(Object.assign(JSON.parse(t.data),a))}catch(r){t.data=t.data+"&"+e}}t.processData||void 0===t.data||"string"==typeof t.data?s():t.data=Object.assign(t.data||{},a)}}))}))})(),this["polylang-pro"]=n})();